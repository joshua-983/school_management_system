{% extends 'base.html' %}

{% block title %}{% if object %}Edit{% else %}Add{% endif %} Student{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h4>{% if object %}Edit{% else %}Register{% endif %} Student</h4>
    </div>
    <div class="card-body">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="row mb-3">
                <div class="col-md-4">
                    <div class="text-center mb-3">
                        {% if object and object.profile_picture %}
                            <img src="{{ object.profile_picture.url }}" class="img-thumbnail" style="max-width: 200px;">
                        {% else %}
                            <div class="bg-light d-flex align-items-center justify-content-center" style="width: 200px; height: 200px;">
                                <span class="text-muted">No image</span>
                            </div>
                        {% endif %}
                    </div>
                    {{ form.profile_picture }}
                </div>
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="{{ form.first_name.id_for_label }}" class="form-label">First Name</label>
                                {{ form.first_name }}
                                {% if form.first_name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.first_name.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="{{ form.middle_name.id_for_label }}" class="form-label">Middle Name</label>
                                {{ form.middle_name }}
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label for="{{ form.last_name.id_for_label }}" class="form-label">Last Name</label>
                                {{ form.last_name }}
                                {% if form.last_name.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.last_name.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.student_id.id_for_label }}" class="form-label">Student ID</label>
                                {{ form.student_id }}
                                {% if form.student_id.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.student_id.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.date_of_birth.id_for_label }}" class="form-label">Date of Birth</label>
                                {{ form.date_of_birth }}
                                {% if form.date_of_birth.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.date_of_birth.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.gender.id_for_label }}" class="form-label">Gender</label>
                                <select name="{{ form.gender.name }}" id="{{ form.gender.id_for_label }}" class="form-select">
                                    <option value="">Select Gender</option>
                                    <option value="M" {% if form.gender.value == 'M' %}selected{% endif %}>Male</option>
                                    <option value="F" {% if form.gender.value == 'F' %}selected{% endif %}>Female</option>
                                </select>
                                {% if form.gender.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.gender.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="{{ form.class_level.id_for_label }}" class="form-label">Class Level</label>
                                {{ form.class_level }}
                                {% if form.class_level.errors %}
                                    <div class="invalid-feedback d-block">
                                        {{ form.class_level.errors.as_text }}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="{{ form.nationality.id_for_label }}" class="form-label">Nationality</label>
                        {{ form.nationality }}
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="{{ form.ethnicity.id_for_label }}" class="form-label">Ethnicity</label>
                        {{ form.ethnicity }}
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="{{ form.religion.id_for_label }}" class="form-label">Religion</label>
                        {{ form.religion }}
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="{{ form.place_of_birth.id_for_label }}" class="form-label">Place of Birth</label>
                        {{ form.place_of_birth }}
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="{{ form.residential_address.id_for_label }}" class="form-label">Residential Address</label>
                {{ form.residential_address }}
            </div>
            
            {% if not object %}
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="id_password1" class="form-label">Password</label>
                        <input type="password" name="password1" class="form-control" id="id_password1" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="id_password2" class="form-label">Confirm Password</label>
                        <input type="password" name="password2" class="form-control" id="id_password2" required>
                    </div>
                </div>
            </div>
            {% endif %}
            
            <div class="d-flex justify-content-between">
                <a href="{% if object %}{% url 'student_detail' object.pk %}{% else %}{% url 'student_list' %}{% endif %}" class="btn btn-secondary">
                    Cancel
                </a>
                <button type="submit" class="btn btn-primary">
                    {% if object %}Update{% else %}Create{% endif %} Student
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}